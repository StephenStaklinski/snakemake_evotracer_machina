Bootstrap: debootstrap
OSVersion: focal
MirrorURL: http://us.archive.ubuntu.com/ubuntu/

%post
    # Install dependencies
    apt update -qq
    apt install -y --no-install-recommends software-properties-common dirmngr wget

    # Add R repository and install R
    wget -qO- https://cloud.r-project.org/bin/linux/ubuntu/marutter_pubkey.asc | tee -a /etc/apt/trusted.gpg.d/cran_ubuntu_key.asc
    add-apt-repository "deb https://cloud.r-project.org/bin/linux/ubuntu $(lsb_release -cs)-cran40/"
    apt install -y --no-install-recommends build-essential r-base

    # Install R packages from CRAN
    Rscript -e "install.packages(c('devtools'), dependencies=TRUE)"
    Rscript -e "devtools::install_github('Nowak-Lab/EvoTraceR', dependencies=TRUE)"

%runscript
    #!/bin/bash
    Rscript -e "$@"
